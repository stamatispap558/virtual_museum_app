<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="../css/mainstyle.css">
    <link rel ="stylesheet" href="../css/footerstyle.css">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Jura&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans+Condensed:wght@300&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
   
    <!--Bootsrap 4 CDN-->
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    
    <!--Fontawesome CDN-->
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">

	<!--Custom styles-->
	<link rel="stylesheet" type="text/css" href="../css/login.css">
    <title>Virtual Archaelogical Museum</title>
    <style>
            /* Dropdown Button */
            .dropbtn {
            color: white;
            font-size: 16px;
            border: none;
        }

        /* The container <div> - needed to position the dropdown content */
        .dropdown {
            position: relative;
            display: inline-block;
        }

        /* Dropdown Content (Hidden by Default) */
        .dropdown-content {
            display: none;
            position: absolute;
            background-color:  #922222;
            min-width: 160px;
            z-index: 1;
        }

        /* Links inside the dropdown */
        .dropdown-content a {
            color:black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
        }

        /* Change color of dropdown links on hover */
        .dropdown-content a:hover {background-color: #ddd;}

        /* Show the dropdown menu on hover */
        .dropdown:hover .dropdown-content {display: block;}
    </style>
</head>
<body>
    <section class="header">
        <nav>
            <a class='logo' href="../../index.html"> <span style="margin-right: 0.4rem;">VIRTUAL</span><span style="font-weight:bold; letter-spacing: 0.2em;">ARCHAELOGICAL MUSEUM</span></a>
            <div class="nav-links" id="navLinks">
                <i class="material-icons" onclick="hideMenu()">close</i>
                <ul>
                    <li><a href="../../index.html">Homepage</a></li>
                    <li><a href="history.html">History</a></li>
                    <li><a href="visit.html">Visit</a></li>
                    <div class="dropdown">
                        <li><a href="collection.html" class="dropbtn">Collections </a></li>
                        <div class="dropdown-content">
                            <a href="subcollectionA1.html">Νεολιθικές Αρχαιότητες</a>
                            <a href="subcollectionA2.html">Κυκλαδικές Αρχαιότητες</a>
                            <a href="subcollectionB1.html">Κλασσική Περίοδος</a>
                            <a href="subcollectionB2.html">Ρωμαϊκή Περίοδος</a>
                            <a href="subcollectionC1.html">Γεωμετρική Περίοδος</a>
                            <a href="subcollectionC2.html">Αρχαϊκή Περίοδος (Μεταλλοτεχνία)</a>
                            <a href="subcollectionD1.html">Αρχαϊκή Περίοδος (Αγγεία)</a>
                            <a href="subcollectionD2.html">Ύστερη Κλασσική Περίοδος</a>
                        </div>
                    </div>
                    <li><a href="events.html">Events</a></li>
                    <li><a href="search.html">Search</a>
                    <li id="login"><a  href="login_prot.html">Login</a></li>
                </ul>
                
            </div>
            <i class="material-icons" onclick="showMenu()">menu</i>
        </nav>
    <!--<div class="login-form">
        <h1>Username</h1>
        <input type="text" id="fname" name="fname"><br><br>
        <h1>Password</h1>
        <input type="password" id="password" name="password"><br><br>
        <input type="submit" value="Submit">
        
    </div>  -->
    <div class="container" id="signin">
        <div class="d-flex justify-content-center h-100">
            <div class="card">
                <div class="card-header">
                    <h3 class="resize">Sign In</h3>
                    <div class="d-flex justify-content-end social_icon">
                        <a href="https://www.facebook.com/namuseum/"><i class="fab fa-facebook-square"></i></a>
                        <a href="https://www.youtube.com/channel/UC8AUjiCKUUOZZ2aPIoXrOrg/videos"><i class="fab fa-youtube-square"></i></a>
                        <a href="https://twitter.com/namuseumathens"><i class="fab fa-twitter-square"></i></a>
                    </div>
                </div>
                <div class="card-body">
                    <form id="loginForm">
                        <div class="input-group form-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text"><i class="fas fa-user"></i></span>
                            </div>
                            <input type="text" class="form-control" name="username" placeholder="username" id="username" required>
                        </div>
                        <div class="input-group form-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text"><i class="fas fa-key"></i></span>
                            </div>
                            <input type="password" class="form-control" name="password" placeholder="password" id="password" required>
                        </div>
                        <div class="row align-items-center remember">
                            <input type="checkbox"> Remember Me
                        </div>
                        <div class="form-group">
                            <input type="submit" value="Login" class="btn float-right login_btn">
                        </div>
                    </form>
                    
                    <div id="errorMessage" style="color:red; display:none;">Login failed, please try again.</div>
                </div>
            </div>
        </div>
    </div>        

    </section>

<script>

    let navLinks = document.getElementById("navLinks");
    function showMenu(){
        navLinks.style.width  = "300px";
    }

    function hideMenu(){
        navLinks.style.width = "0px";
    }

    document.getElementById('loginForm').addEventListener('submit', async function(event) {
        event.preventDefault(); // Prevent form from submitting the default way

        // Get the form data
        const username = document.getElementById('username').value;
        const password = document.getElementById('password').value;

        try {
            // Send a POST request using fetch
            const response = await fetch('/apilog/login', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    username: username,
                    password: password
                })
            });

            // Parse the response as JSON
            const data = await response.json();

            if (response.ok && data.success) {
                localStorage.setItem('loggedIn', 'true');

                // If login is successful, redirect to the desired HTML page
                window.location.href = data.redirectUrl; // This comes from the API response
            } else {
                // Show an error message if login fails
                document.getElementById('errorMessage').style.display = 'block';
                document.getElementById('errorMessage').textContent = data.message || 'Login failed, please try again.';
            }
        } catch (error) {
            console.error('Error during login:', error);
            // Show an error message
            document.getElementById('errorMessage').style.display = 'block';
            document.getElementById('errorMessage').textContent = 'An error occurred, please try again later.';
        }
    });
</script>
<script type="text/javascript" src="../js/login.js"></script>       
    
    
</body>

</html>
